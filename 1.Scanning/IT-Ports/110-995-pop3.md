# Port 110/995 - POP3

## Table of Contents

- [Enumeration](#enumeration)
  - [Banner Grabbing](#banner-grabbing)
  - [Nmap Scripts](#nmap-scripts)
  - [Manual Enumeration](#manual-enumeration)
- [Brute Force](#brute-force)
- [Post-Exploitation](#post-exploitation)

---

## Enumeration

### Quick Check (One-liner)

```shell
nmap -p 110,995 --script "pop3-capabilities,pop3-ntlm-info" $rhost && nc -nv $rhost 110
```

### Banner Grabbing

```shell
# Netcat
nc -nv $rhost 110

# Telnet
telnet $rhost 110

# OpenSSL (POP3S - 995)
openssl s_client -connect $rhost:995 -crlf -quiet
```

### Nmap Scripts

```shell
# Service detection
nmap -p 110,995 -sV $rhost

# POP3 enumeration
nmap -p 110 --script "pop3-capabilities" $rhost
nmap -p 110 --script "pop3-ntlm-info" $rhost
```

### Manual Enumeration

```shell
# Connect to POP3
nc -nv $rhost 110

# or telnet
telnet $rhost 110

# Login
USER username
PASS password

# Commands after login
LIST         # List messages with size
STAT         # Number of messages and total size
RETR 1       # Retrieve message 1
TOP 1 10     # Get headers + first 10 lines of message 1
DELE 1       # Delete message 1
RSET         # Reset (undelete)
QUIT         # Logout
```

---

## Brute Force

### Hydra

```shell
# POP3
hydra -l username -P /usr/share/wordlists/rockyou.txt -f $rhost pop3

# POP3S
hydra -l username -P /usr/share/wordlists/rockyou.txt -f -s 995 $rhost pop3s
```

### Nmap

```shell
nmap -p 110 --script "pop3-brute" $rhost
```

---

## Post-Exploitation

### Read All Emails

```shell
# Connect and login
nc -nv $rhost 110
USER username
PASS password

# Check number of messages
STAT

# Read each message
RETR 1
RETR 2
# ... continue for all messages
```

### Extract Credentials

> Look for passwords, credentials, or sensitive information in emails

```shell
# Common things to look for:
# - Password reset emails
# - Account creation confirmations
# - Internal communications with credentials
# - Attachments (may contain sensitive files)
```

---

## POP3 Commands Reference

| Command | Description |
| --- | --- |
| USER | Username for authentication |
| PASS | Password for authentication |
| STAT | Get mailbox statistics |
| LIST | List messages |
| RETR | Retrieve a message |
| DELE | Mark message for deletion |
| RSET | Reset/undelete messages |
| TOP | Get headers and first n lines |
| NOOP | No operation |
| QUIT | Close connection |
