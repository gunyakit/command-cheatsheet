# Port 3690 - Subversion (SVN)

## Table of Contents

- [Enumeration](#enumeration)
- [Exploitation](#exploitation)
- [Post Exploitation](#post-exploitation)

---

## Enumeration

### Quick Check (One-liner)

```shell
svn ls svn://$rhost/ && svn info svn://$rhost/
```

### Nmap Scripts

```shell
nmap -sV -sC -p3690 $rhost
nmap -p3690 --script "svn-brute" $rhost
```

### Banner Grabbing

```shell
nc -vn $rhost 3690
```

### List Repository

```shell
# List root
svn ls svn://$rhost/

# List specific repo
svn ls svn://$rhost/repository

# Recursive list
svn ls -R svn://$rhost/repository
```

### Check Repository Info

```shell
svn info svn://$rhost/repository
```

---

## Exploitation

### Anonymous Access

```shell
# Try listing without authentication
svn ls svn://$rhost/

# Checkout repository
svn checkout svn://$rhost/repository ./repo_copy

# Export (without .svn metadata)
svn export svn://$rhost/repository ./repo_export
```

### Brute Force

```shell
# Nmap SVN brute
nmap -p3690 --script "svn-brute" \
  --script-args userdb=/usr/share/seclists/Usernames/top-usernames-shortlist.txt,passdb=/usr/share/wordlists/rockyou.txt \
  $rhost

# Hydra
hydra -L users.txt -P /usr/share/wordlists/rockyou.txt svn://$rhost
```

### View Commit History

```shell
# View all logs
svn log svn://$rhost/repository

# View specific revision
svn log -r 1:5 svn://$rhost/repository

# View with changed paths
svn log -v svn://$rhost/repository
```

### Retrieve Old Revisions

```shell
# Checkout specific revision
svn checkout -r 10 svn://$rhost/repository ./old_version

# Show diff between revisions
svn diff -r 10:20 svn://$rhost/repository

# Cat file at specific revision
svn cat -r 10 svn://$rhost/repository/file.txt
```

---

## Post Exploitation

### Search for Sensitive Data

```shell
# Download entire repository
svn checkout svn://$rhost/repository ./repo

# Search for credentials
grep -rni "password\|passwd\|secret\|key\|token\|api" ./repo

# Search for config files
find ./repo -name "*.conf" -o -name "*.cfg" -o -name "*.ini"

# Search in commit messages
svn log svn://$rhost/repository | grep -i "password\|credential\|fix\|bug"
```

### Extract Deleted Files

```shell
# Find deleted files in history
svn log -v svn://$rhost/repository | grep "^   D"

# Retrieve deleted file from previous revision
svn cat -r PREV svn://$rhost/repository/deleted_file.txt

# Blame/annotate to see who changed what
svn blame svn://$rhost/repository/file.txt
```

### Configuration Files

```shell
# SVN server config locations
/etc/subversion/
/etc/apache2/mods-enabled/dav_svn.conf
~/.subversion/

# Repository config
repo/conf/svnserve.conf
repo/conf/passwd
repo/conf/authz
```

### Hooks

```shell
# Check for hooks that might reveal info or be exploitable
ls -la repository/hooks/
cat repository/hooks/pre-commit
cat repository/hooks/post-commit
```

---

## HTTP/HTTPS SVN (WebDAV)

```shell
# SVN over HTTP
svn ls http://$rhost/svn/repository

# With authentication
svn ls --username user --password pass http://$rhost/svn/repository

# Check WebDAV methods
curl -X OPTIONS http://$rhost/svn/ -I
```

---

## Tools

- svn client: `apt install subversion`
- svn-extractor: https://github.com/anantshri/svn-extractor
- dvcs-ripper: https://github.com/kost/dvcs-ripper

---

## References

- [HackTricks - SVN](https://book.hacktricks.wiki/network-services-pentesting/3690-pentesting-subversion-svn-server.html)
