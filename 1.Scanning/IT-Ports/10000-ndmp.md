# Port 10000 - NDMP (Network Data Management Protocol)

## Table of Contents

- [Enumeration](#enumeration)
- [Exploitation](#exploitation)
- [Information Gathering](#information-gathering)

---

## Enumeration

### Nmap Scripts

```shell
nmap -sV -sC -p10000 $rhost
nmap -p10000 --script ndmp-fs-info,ndmp-version $rhost
```

### Banner Grabbing

```shell
nc -vn $rhost 10000
```

### Version Detection

```shell
nmap -p10000 --script ndmp-version $rhost
```

---

## Exploitation

### Default Credentials

```shell
# Common default credentials for NDMP
# Often uses system credentials or specific backup software credentials

# NetApp
admin:admin
root:netapp

# EMC
admin:changeme
nasadmin:nasadmin

# Veritas
admin:admin
```

### Brute Force

```shell
# Hydra (if supported)
hydra -L users.txt -P /usr/share/wordlists/rockyou.txt $rhost ndmp

# Custom script using NDMP protocol
```

### NDMP File System Enumeration

```shell
# Using nmap scripts
nmap -p10000 --script ndmp-fs-info $rhost

# Output reveals:
# - Filesystem paths
# - Mount points
# - Backup device info
```

---

## Information Gathering

### List Filesystems

```shell
# Using ndmpcopy or similar tools
ndmpcopy -h $rhost -u admin -p password list

# Using nmap
nmap -p10000 --script ndmp-fs-info $rhost
```

### Device Information

```shell
# NDMP reveals:
# - Storage device info
# - Tape drive info
# - File system layout
# - Backup configurations
```

### Common NDMP Implementations

| Vendor | Default Port | Notes |
| --- | --- | --- |
| NetApp | 10000 | Data ONTAP |
| EMC | 10000 | Celerra, Isilon |
| Oracle | 10000 | ZFS Storage |
| Veritas | 10000 | NetBackup |

---

## Post Exploitation

### Access Backup Data

```shell
# If authenticated, can potentially:
# - Read backup data
# - Access file systems
# - Retrieve sensitive files from backups
```

### Configuration Files

```shell
# Common config locations
/etc/ndmp/ndmpd.conf
/etc/default/ndmpd
```

### Log Files

```shell
# NDMP logs may contain sensitive info
/var/log/ndmp.log
/var/log/backup.log
```

---

## Tools

- ndmpcopy
- Nmap NDMP scripts
- Vendor-specific backup tools

---

## References

- [HackTricks - NDMP](https://book.hacktricks.wiki/network-services-pentesting/10000-network-data-management-protocol-ndmp.html)
- [RFC 2866 - NDMP](https://tools.ietf.org/html/rfc2866)
