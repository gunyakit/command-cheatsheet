# Port 548 - AFP (Apple Filing Protocol)

## Table of Contents
- [Enumeration](#enumeration)
- [Connect and Access](#connect-and-access)
- [Exploitation](#exploitation)

---

## Enumeration

### Quick Check (One-liner)

```shell
nmap -p 548 --script "afp-serverinfo,afp-showmount" $rhost
```

### Nmap

```shell
nmap -sV -sC -p 548 $rhost
nmap -p 548 --script "afp-serverinfo" $rhost
nmap -p 548 --script "afp-ls" $rhost
nmap -p 548 --script "afp-showmount" $rhost
```

### Get Server Info

```shell
# Using Nmap
nmap -p 548 --script "afp-serverinfo" $rhost
```

---

## Connect and Access

### macOS Finder

```shell
# Open Finder and press Cmd+K
# Enter: afp://$rhost

# Or from terminal
open afp://$rhost
```

### Linux Access

```shell
# Install afpfs-ng
apt install afpfs-ng

# Mount AFP share
mount_afp afp://user:password@$rhost/share /mnt/afp

# Using afpclient
afpclient $rhost
```

---

## Exploitation

### Anonymous Access

```shell
# Check for anonymous access
nmap -p 548 --script "afp-showmount" $rhost

# List shares without auth
nmap -p 548 --script "afp-ls" $rhost
```

### Brute Force

```shell
# Nmap brute force
nmap -p 548 --script "afp-brute" $rhost

# With wordlists
nmap -p 548 --script "afp-brute" \
  --script-args userdb=users.txt,passdb=passwords.txt $rhost
```

### Path Traversal

```shell
# Check for path traversal in share names
nmap -p 548 --script "afp-path-vuln" $rhost
```

### Information Disclosure

```shell
# Server info reveals:
# - Server name
# - Machine type
# - AFP version
# - UAM (authentication methods)
# - Flags (guest access, etc.)

nmap -p 548 --script "afp-serverinfo" $rhost
```

---

## Nmap Scripts

| Script | Description |
| :--- | :--- |
| `afp-serverinfo` | Get server information |
| `afp-showmount` | List available shares |
| `afp-ls` | List files in shares |
| `afp-brute` | Brute force credentials |
| `afp-path-vuln` | Check path traversal |

---

## Quick Reference

| Command | Description |
| :--- | :--- |
| `nmap -p 548 --script "afp-serverinfo" $rhost` | Get server info |
| `nmap -p 548 --script "afp-showmount" $rhost` | List shares |
| `nmap -p 548 --script "afp-brute" $rhost` | Brute force |
| `open afp://$rhost` | Connect from macOS |
